\documentclass{article}
\usepackage{agda}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[verbose]{newunicodechar}
\input{unicode}
\begin{document}

\begin{code}%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Agda.Builtin.Nat}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}<\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}<ᵇ\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}==\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}=n\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Function.Base}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.String}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{String}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromChar}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}++\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{concat}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Bool}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{hiding}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{not}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Unit}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.List}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{hiding}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}++\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{or}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{and}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{lookup}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{concat}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Agda.Builtin.Char}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Char}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}==\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}=c\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Product}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Maybe.Base}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}>>=\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}o>=\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{map?}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Agda.Builtin.Equality}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{basic}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{hiding}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{F}\AgdaSpace{}%
\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{all}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{Res}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{cont}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Chars}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Res}\AgdaSpace{}%
\AgdaBound{A}\<%
\\
%
\>[2]\AgdaInductiveConstructor{stop}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{String}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Res}\AgdaSpace{}%
\AgdaBound{A}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{Parse}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Set}\<%
\\
\>[0]\AgdaFunction{Parse}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Chars}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Res}\AgdaSpace{}%
\AgdaBound{A}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{infixl}\AgdaSpace{}%
\AgdaNumber{20}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}>>=\AgdaUnderscore{}}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}>>=\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{B}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Parse}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Parse}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Parse}\AgdaSpace{}%
\AgdaBound{B}\<%
\\
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}>>=\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaBound{cs}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{cs}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{stop}\AgdaSpace{}%
\AgdaBound{msg}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{stop}\AgdaSpace{}%
\AgdaBound{msg}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{cont}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaBound{cs'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaBound{cs'}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}>>\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{B}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Parse}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Parse}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Parse}\AgdaSpace{}%
\AgdaBound{B}\<%
\\
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}>>\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaBound{cs}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{cs}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{stop}\AgdaSpace{}%
\AgdaBound{msg}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{stop}\AgdaSpace{}%
\AgdaBound{msg}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{cont}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{cs'}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaBound{cs'}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{infixr}\AgdaSpace{}%
\AgdaNumber{20}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}<|>\AgdaUnderscore{}}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}<|>\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Parse}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Parse}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Parse}\AgdaSpace{}%
\AgdaBound{A}\<%
\\
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}<|>\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaBound{cs}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{cs}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{stop}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaBound{cs}\<%
\\
\>[0]\AgdaCatchallClause{\AgdaSymbol{...}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{|}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{c}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{c}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{pass}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Parse}\AgdaSpace{}%
\AgdaBound{A}\<%
\\
\>[0]\AgdaFunction{pass}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{cs}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{cont}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{cs}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{fail}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{String}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Parse}\AgdaSpace{}%
\AgdaBound{A}\<%
\\
\>[0]\AgdaFunction{fail}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{stop}\AgdaSpace{}%
\AgdaBound{s}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{skip}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Parse}\AgdaSpace{}%
\AgdaRecord{⊤}\<%
\\
\>[0]\AgdaFunction{skip}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{pass}\AgdaSpace{}%
\AgdaInductiveConstructor{tt}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{-------- Admissability Check --------}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{fi<?}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Functor}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Bool}\<%
\\
\>[0]\AgdaFunction{fi<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{indexed}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{<ᵇ}}\AgdaSpace{}%
\AgdaBound{k}\<%
\\
\>[0]\AgdaFunction{fi<?}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{plain}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{term-lfi<?}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Term}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Bool}\<%
\\
\>[0]\AgdaFunction{terms-lfi<?}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Terms}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Bool}\<%
\\
\>[0]\AgdaFunction{term-lfi<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{var}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\<%
\\
\>[0]\AgdaFunction{term-lfi<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{fun}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{ts}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{fi<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∧}}\AgdaSpace{}%
\AgdaFunction{terms-lfi<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{ts}\<%
\\
\>[0]\AgdaFunction{terms-lfi<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\<%
\\
\>[0]\AgdaFunction{terms-lfi<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{ts}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{term-lfi<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∧}}\AgdaSpace{}%
\AgdaFunction{terms-lfi<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{ts}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{formula-lfi<?}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Formula}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Bool}\<%
\\
\>[0]\AgdaFunction{formula-lfi<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{cst}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\<%
\\
\>[0]\AgdaFunction{formula-lfi<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{rel}\AgdaSpace{}%
\AgdaBound{r}\AgdaSpace{}%
\AgdaBound{ts}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{fi<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{r}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∧}}\AgdaSpace{}%
\AgdaFunction{terms-lfi<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{ts}\<%
\\
\>[0]\AgdaFunction{formula-lfi<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{not}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{formula-lfi<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{f}\<%
\\
\>[0]\AgdaFunction{formula-lfi<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{qtf}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{formula-lfi<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{f}\<%
\\
\>[0]\AgdaFunction{formula-lfi<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{bct}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{g}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{formula-lfi<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∧}}\AgdaSpace{}%
\AgdaFunction{formula-lfi<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{g}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{-------- Parsers --------}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{lift-parse}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Maybe}\AgdaSpace{}%
\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Parse}\AgdaSpace{}%
\AgdaBound{A}\<%
\\
\>[0]\AgdaFunction{lift-parse}\AgdaSpace{}%
\AgdaInductiveConstructor{nothing}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{fail}\AgdaSpace{}%
\AgdaString{"Cannot lift nothing"}\<%
\\
\>[0]\AgdaFunction{lift-parse}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{just}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{pass}\AgdaSpace{}%
\AgdaBound{a}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{pass-if}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Bool}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Parse}\AgdaSpace{}%
\AgdaRecord{⊤}\<%
\\
\>[0]\AgdaFunction{pass-if}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{pass}\AgdaSpace{}%
\AgdaInductiveConstructor{tt}\<%
\\
\>[0]\AgdaFunction{pass-if}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{fail}\AgdaSpace{}%
\AgdaString{"Pass-if test failed"}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{parse-bool}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Parse}\AgdaSpace{}%
\AgdaDatatype{Bool}\<%
\\
\>[0]\AgdaFunction{parse-bool}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaString{'0'}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{cs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{cont}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSpace{}%
\AgdaBound{cs}\<%
\\
\>[0]\AgdaFunction{parse-bool}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaString{'1'}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{cs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{cont}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\AgdaSpace{}%
\AgdaBound{cs}\<%
\\
\>[0]\AgdaCatchallClause{\AgdaFunction{parse-bool}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{stop}\AgdaSpace{}%
\AgdaString{"Cannot parse bool (head char neither '0' nor '1')"}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{parse-char}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Parse}\AgdaSpace{}%
\AgdaPostulate{Char}\<%
\\
\>[0]\AgdaFunction{parse-char}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{c}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{cs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{cont}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{cs}\<%
\\
\>[0]\AgdaFunction{parse-char}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{fail}\AgdaSpace{}%
\AgdaString{"Cannot parse char from empty string"}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{parse-chars}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Parse}\AgdaSpace{}%
\AgdaFunction{Chars}\<%
\\
\>[0]\AgdaFunction{parse-chars}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaString{'\%'}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{cs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{cont}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaBound{cs}\<%
\\
\>[0]\AgdaFunction{parse-chars}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{c}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{cs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{with}\AgdaSpace{}%
\AgdaFunction{parse-chars}\AgdaSpace{}%
\AgdaBound{cs}\<%
\\
\>[0]\AgdaSymbol{...}\AgdaSpace{}%
\AgdaSymbol{|}\AgdaSpace{}%
\AgdaInductiveConstructor{cont}\AgdaSpace{}%
\AgdaBound{cs0}\AgdaSpace{}%
\AgdaBound{cs1}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{cont}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{c}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{cs0}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{cs1}\<%
\\
\>[0]\AgdaCatchallClause{\AgdaSymbol{...}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{|}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaBound{st}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{st}\<%
\\
\>[0]\AgdaFunction{parse-chars}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{fail}\AgdaSpace{}%
\AgdaString{"parse-char fail : reached end of input string before endmarker"}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{parse-nat}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Parse}\AgdaSpace{}%
\AgdaDatatype{Nat}\<%
\\
\>[0]\AgdaFunction{parse-nat}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{parse-chars}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{>>=}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{lift-parse}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaFunction{chars-to-nat}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}==c\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Char}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{Char}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Bool}\<%
\\
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}==c\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaPrimitive{primCharEquality}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{parse-spec-char}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Char}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Parse}\AgdaSpace{}%
\AgdaRecord{⊤}\<%
\\
\>[0]\AgdaFunction{parse-spec-char}\AgdaSpace{}%
\AgdaBound{c0}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{c1}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{cs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaOperator{\AgdaFunction{if}}\AgdaSpace{}%
\AgdaBound{c0}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{==c}}\AgdaSpace{}%
\AgdaBound{c1}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaOperator{\AgdaFunction{then}}\AgdaSpace{}%
\AgdaInductiveConstructor{cont}\AgdaSpace{}%
\AgdaInductiveConstructor{tt}\AgdaSpace{}%
\AgdaBound{cs}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{else}}\AgdaSpace{}%
\AgdaInductiveConstructor{stop}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaString{"char expected = "}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaFunction{fromChar}\AgdaSpace{}%
\AgdaBound{c0}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaString{", char parse = "}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaFunction{fromChar}\AgdaSpace{}%
\AgdaBound{c1}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{parse-spec-char}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{fail}\AgdaSpace{}%
\AgdaString{"parse-spec-char fail : reached end of input string before endmarker"}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{parse-functor}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Parse}\AgdaSpace{}%
\AgdaDatatype{Functor}\<%
\\
\>[0]\AgdaFunction{parse-functor}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaKeyword{do}%
\>[484I]\AgdaFunction{parse-spec-char}\AgdaSpace{}%
\AgdaString{'\#'}\<%
\\
\>[.][@{}l@{}]\<[484I]%
\>[7]\AgdaBound{k}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-nat}\<%
\\
%
\>[7]\AgdaFunction{pass}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{indexed}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{<|>}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaKeyword{do}%
\>[493I]\AgdaFunction{parse-spec-char}\AgdaSpace{}%
\AgdaString{'"'}\<%
\\
\>[.][@{}l@{}]\<[493I]%
\>[7]\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-chars}\<%
\\
%
\>[7]\AgdaFunction{pass}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{plain}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{parse-term}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Parse}\AgdaSpace{}%
\AgdaDatatype{Term}\<%
\\
\>[0]\AgdaFunction{parse-terms}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Parse}\AgdaSpace{}%
\AgdaFunction{Terms}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{parse-term}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaString{'\#'}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{cs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaKeyword{do}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaBound{k}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-nat}\<%
\\
%
\>[2]\AgdaFunction{pass}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{var}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{cs}\<%
\\
\>[0]\AgdaFunction{parse-term}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaString{'\$'}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{cs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaKeyword{do}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-functor}\<%
\\
%
\>[2]\AgdaBound{ts}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-terms}\AgdaSpace{}%
\AgdaBound{k}\<%
\\
%
\>[2]\AgdaFunction{pass}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{fun}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{ts}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{cs}\<%
\\
\>[0]\AgdaCatchallClause{\AgdaFunction{parse-term}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{fail}\AgdaSpace{}%
\AgdaString{"parse-term fail"}\<%
\\
\>[0]\AgdaFunction{parse-terms}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaString{'.'}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{cs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{cont}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaBound{cs}\<%
\\
\>[0]\AgdaFunction{parse-terms}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaString{','}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{cs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaKeyword{do}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-term}\AgdaSpace{}%
\AgdaBound{k}\<%
\\
%
\>[2]\AgdaBound{ts}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-terms}\AgdaSpace{}%
\AgdaBound{k}\<%
\\
%
\>[2]\AgdaFunction{pass}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{ts}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{cs}\<%
\\
\>[0]\AgdaCatchallClause{\AgdaFunction{parse-terms}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{fail}\AgdaSpace{}%
\AgdaString{"parse-terms fail"}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{parse-qtf}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Parse}\AgdaSpace{}%
\AgdaDatatype{Bool}\<%
\\
\>[0]\AgdaFunction{parse-qtf}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}\AgdaFunction{parse-spec-char}\AgdaSpace{}%
\AgdaString{'!'}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{>>}}\AgdaSpace{}%
\AgdaFunction{pass}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{<|>}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{parse-spec-char}\AgdaSpace{}%
\AgdaString{'?'}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{>>}}\AgdaSpace{}%
\AgdaFunction{pass}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{parse-bct}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Parse}\AgdaSpace{}%
\AgdaDatatype{Bct}\<%
\\
\>[0]\AgdaFunction{parse-bct}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}\AgdaFunction{parse-spec-char}\AgdaSpace{}%
\AgdaString{'|'}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{>>}}\AgdaSpace{}%
\AgdaFunction{pass}\AgdaSpace{}%
\AgdaInductiveConstructor{or}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{<|>}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaFunction{parse-spec-char}\AgdaSpace{}%
\AgdaString{'\&'}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{>>}}\AgdaSpace{}%
\AgdaFunction{pass}\AgdaSpace{}%
\AgdaInductiveConstructor{and}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{<|>}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaFunction{parse-spec-char}\AgdaSpace{}%
\AgdaString{'>'}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{>>}}\AgdaSpace{}%
\AgdaFunction{pass}\AgdaSpace{}%
\AgdaInductiveConstructor{imp}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{<|>}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaFunction{parse-spec-char}\AgdaSpace{}%
\AgdaString{'='}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{>>}}\AgdaSpace{}%
\AgdaFunction{pass}\AgdaSpace{}%
\AgdaInductiveConstructor{iff}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{parse-form}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Parse}\AgdaSpace{}%
\AgdaDatatype{Formula}\<%
\\
\>[0]\AgdaFunction{parse-form}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}\AgdaFunction{parse-bool}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{>>=}}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{pass}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{cst}\AgdaSpace{}%
\AgdaBound{b}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{<|>}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaKeyword{do}%
\>[630I]\AgdaFunction{parse-spec-char}\AgdaSpace{}%
\AgdaString{'\$'}\<%
\\
\>[.][@{}l@{}]\<[630I]%
\>[7]\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-functor}\<%
\\
%
\>[7]\AgdaBound{ts}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-terms}\AgdaSpace{}%
\AgdaBound{k}\<%
\\
%
\>[7]\AgdaFunction{pass}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{rel}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{ts}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{<|>}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaKeyword{do}%
\>[643I]\AgdaFunction{parse-spec-char}\AgdaSpace{}%
\AgdaString{'\textasciitilde{}'}\<%
\\
\>[.][@{}l@{}]\<[643I]%
\>[7]\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-form}\AgdaSpace{}%
\AgdaBound{k}\<%
\\
%
\>[7]\AgdaFunction{pass}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{not}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{<|>}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaKeyword{do}%
\>[653I]\AgdaBound{b}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-qtf}\<%
\\
\>[.][@{}l@{}]\<[653I]%
\>[7]\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-form}\AgdaSpace{}%
\AgdaBound{k}\<%
\\
%
\>[7]\AgdaFunction{pass}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{qtf}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{<|>}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaKeyword{do}%
\>[665I]\AgdaBound{b}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-bct}\<%
\\
\>[.][@{}l@{}]\<[665I]%
\>[7]\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-form}\AgdaSpace{}%
\AgdaBound{k}\<%
\\
%
\>[7]\AgdaBound{g}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-form}\AgdaSpace{}%
\AgdaBound{k}\<%
\\
%
\>[7]\AgdaFunction{pass}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{bct}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{g}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{parse-form}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{fail}\AgdaSpace{}%
\AgdaString{"parse-form fail"}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{parse-af}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Parse}\AgdaSpace{}%
\AgdaDatatype{Formula}\<%
\\
\>[0]\AgdaFunction{parse-af}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[14]\AgdaKeyword{do}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}\AgdaFunction{parse-chars}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{>>}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{parse-bool}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{>>=}}\AgdaSpace{}%
\AgdaFunction{pass-if}\AgdaSymbol{))}\<%
\\
%
\>[2]\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-form}\AgdaSpace{}%
\AgdaBound{k}\<%
\\
%
\>[2]\AgdaFunction{pass-if}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{formula-lfi<?}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{parse-spec-char}\AgdaSpace{}%
\AgdaString{'0'}\<%
\\
%
\>[2]\AgdaFunction{pass}\AgdaSpace{}%
\AgdaBound{f}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{Sequent}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaDatatype{Tree}\AgdaSpace{}%
\AgdaDatatype{Formula}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{nth}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Sequent}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Formula}\<%
\\
\>[0]\AgdaFunction{nth}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{lookup}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaFunction{⊤*}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{parse-sequent-core}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Sequent}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Parse}\AgdaSpace{}%
\AgdaFunction{Sequent}\<%
\\
\>[0]\AgdaFunction{parse-sequent-core}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}\AgdaFunction{parse-spec-char}\AgdaSpace{}%
\AgdaString{'.'}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{>>}}\AgdaSpace{}%
\AgdaFunction{pass}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{<|>}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaKeyword{do}%
\>[735I]\AgdaFunction{parse-spec-char}\AgdaSpace{}%
\AgdaString{','}\<%
\\
\>[.][@{}l@{}]\<[735I]%
\>[7]\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-af}\AgdaSpace{}%
\AgdaBound{k}\<%
\\
%
\>[7]\AgdaFunction{parse-sequent-core}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{add}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{parse-sequent-core}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{fail}\AgdaSpace{}%
\AgdaString{"parse-sequent-core fail"}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{parse-sequent}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Parse}\AgdaSpace{}%
\AgdaFunction{Sequent}\<%
\\
\>[0]\AgdaFunction{parse-sequent}\AgdaSpace{}%
\AgdaBound{cs}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{parse-sequent-core}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{length}\AgdaSpace{}%
\AgdaBound{cs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{empty}\AgdaSpace{}%
\AgdaBound{cs}\<%
\end{code}

%<*proof>
\begin{code}%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{Proof}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{rule-a}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Bool}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Proof}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Proof}\<%
\\
%
\>[2]\AgdaInductiveConstructor{rule-b}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Proof}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Proof}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Proof}\<%
\\
%
\>[2]\AgdaInductiveConstructor{rule-c}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Term}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Proof}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Proof}\<%
\\
%
\>[2]\AgdaInductiveConstructor{rule-d}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Proof}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Proof}\<%
\\
%
\>[2]\AgdaInductiveConstructor{rule-n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Proof}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Proof}\<%
\\
%
\>[2]\AgdaInductiveConstructor{rule-s}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Formula}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Proof}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Proof}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Proof}\<%
\\
%
\>[2]\AgdaInductiveConstructor{rule-t}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Formula}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Proof}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Proof}\<%
\\
%
\>[2]\AgdaInductiveConstructor{rule-x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Proof}\<%
\end{code}
%</proof>

\begin{code}%
\>[0]\AgdaFunction{parse-prf-core}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Parse}\AgdaSpace{}%
\AgdaDatatype{Proof}\<%
\\
\>[0]\AgdaFunction{parse-prf-core}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaKeyword{do}%
\>[829I]\AgdaFunction{parse-spec-char}\AgdaSpace{}%
\AgdaString{'A'}\<%
\\
\>[.][@{}l@{}]\<[829I]%
\>[7]\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-nat}\<%
\\
%
\>[7]\AgdaBound{b}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-bool}\<%
\\
%
\>[7]\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-prf-core}\AgdaSpace{}%
\AgdaBound{k}\<%
\\
%
\>[7]\AgdaFunction{pass}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{rule-a}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{<|>}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaKeyword{do}%
\>[845I]\AgdaFunction{parse-spec-char}\AgdaSpace{}%
\AgdaString{'B'}\<%
\\
\>[.][@{}l@{}]\<[845I]%
\>[7]\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-nat}\<%
\\
%
\>[7]\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-prf-core}\AgdaSpace{}%
\AgdaBound{k}\<%
\\
%
\>[7]\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-prf-core}\AgdaSpace{}%
\AgdaBound{k}\<%
\\
%
\>[7]\AgdaFunction{pass}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{rule-b}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{<|>}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaKeyword{do}%
\>[862I]\AgdaFunction{parse-spec-char}\AgdaSpace{}%
\AgdaString{'C'}\<%
\\
\>[.][@{}l@{}]\<[862I]%
\>[7]\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-nat}\<%
\\
%
\>[7]\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-term}\AgdaSpace{}%
\AgdaBound{k}\<%
\\
%
\>[7]\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-prf-core}\AgdaSpace{}%
\AgdaBound{k}\<%
\\
%
\>[7]\AgdaFunction{pass}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{rule-c}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{<|>}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaKeyword{do}%
\>[879I]\AgdaFunction{parse-spec-char}\AgdaSpace{}%
\AgdaString{'D'}\<%
\\
\>[.][@{}l@{}]\<[879I]%
\>[7]\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-nat}\<%
\\
%
\>[7]\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-prf-core}\AgdaSpace{}%
\AgdaBound{k}\<%
\\
%
\>[7]\AgdaFunction{pass}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{rule-d}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{<|>}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaKeyword{do}%
\>[892I]\AgdaFunction{parse-spec-char}\AgdaSpace{}%
\AgdaString{'N'}\<%
\\
\>[.][@{}l@{}]\<[892I]%
\>[7]\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-nat}\<%
\\
%
\>[7]\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-prf-core}\AgdaSpace{}%
\AgdaBound{k}\<%
\\
%
\>[7]\AgdaFunction{pass}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{rule-n}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{<|>}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaKeyword{do}%
\>[905I]\AgdaFunction{parse-spec-char}\AgdaSpace{}%
\AgdaString{'S'}\<%
\\
\>[.][@{}l@{}]\<[905I]%
\>[7]\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-form}\AgdaSpace{}%
\AgdaBound{k}\<%
\\
%
\>[7]\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-prf-core}\AgdaSpace{}%
\AgdaBound{k}\<%
\\
%
\>[7]\AgdaBound{q}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-prf-core}\AgdaSpace{}%
\AgdaBound{k}\<%
\\
%
\>[7]\AgdaFunction{pass}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{rule-s}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{<|>}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaKeyword{do}%
\>[923I]\AgdaFunction{parse-spec-char}\AgdaSpace{}%
\AgdaString{'T'}\<%
\\
\>[.][@{}l@{}]\<[923I]%
\>[7]\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-form}\AgdaSpace{}%
\AgdaBound{k}\<%
\\
%
\>[7]\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-prf-core}\AgdaSpace{}%
\AgdaBound{k}\<%
\\
%
\>[7]\AgdaFunction{pass}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{rule-t}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{<|>}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaKeyword{do}%
\>[937I]\AgdaFunction{parse-spec-char}\AgdaSpace{}%
\AgdaString{'X'}\<%
\\
\>[.][@{}l@{}]\<[937I]%
\>[7]\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-nat}\<%
\\
%
\>[7]\AgdaBound{j}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{←}}\AgdaSpace{}%
\AgdaFunction{parse-nat}\<%
\\
%
\>[7]\AgdaFunction{pass}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{rule-x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaBound{j}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{parse-prf-core}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{fail}\AgdaSpace{}%
\AgdaString{"parse-prf fail"}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{parse-prf}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Parse}\AgdaSpace{}%
\AgdaDatatype{Proof}\<%
\\
\>[0]\AgdaFunction{parse-prf}\AgdaSpace{}%
\AgdaBound{cs}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{parse-prf-core}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{length}\AgdaSpace{}%
\AgdaBound{cs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{cs}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{refl-axiom}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Formula}\<%
\\
\>[0]\AgdaFunction{refl-axiom}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{∀*}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{var}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{=*}}\AgdaSpace{}%
\AgdaInductiveConstructor{var}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{symm-axiom}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Formula}\<%
\\
\>[0]\AgdaFunction{symm-axiom}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{∀*}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{∀*}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaInductiveConstructor{var}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{=*}}\AgdaSpace{}%
\AgdaInductiveConstructor{var}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{→*}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{var}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{=*}}\AgdaSpace{}%
\AgdaInductiveConstructor{var}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{)))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{trans-axiom}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Formula}\<%
\\
\>[0]\AgdaFunction{trans-axiom}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{∀*}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{∀*}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{∀*}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaInductiveConstructor{var}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{=*}}\AgdaSpace{}%
\AgdaInductiveConstructor{var}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{→*}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaInductiveConstructor{var}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{=*}}\AgdaSpace{}%
\AgdaInductiveConstructor{var}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{→*}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{var}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{=*}}\AgdaSpace{}%
\AgdaInductiveConstructor{var}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSymbol{)))))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{mono-args-lft}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Terms}\<%
\\
\>[0]\AgdaFunction{mono-args-lft}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\\
\>[0]\AgdaFunction{mono-args-lft}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{var}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*}}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSymbol{)))}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{mono-args-lft}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{mono-args-rgt}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Terms}\<%
\\
\>[0]\AgdaFunction{mono-args-rgt}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\<%
\\
\>[0]\AgdaFunction{mono-args-rgt}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{var}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*}}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{mono-args-rgt}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{mono-fun?}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Formula}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Bool}\<%
\\
\>[0]\AgdaFunction{mono-fun?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{qtf}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{qtf}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{bct}\AgdaSpace{}%
\AgdaInductiveConstructor{imp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{rel}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{plain}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{c}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaInductiveConstructor{var}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{var}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)))}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}\AgdaBound{c}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{=c}}\AgdaSpace{}%
\AgdaString{'='}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∧}}\AgdaSpace{}%
\AgdaFunction{mono-fun?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{f}\<%
\\
\>[0]\AgdaFunction{mono-fun?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{rel}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{plain}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{c}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaInductiveConstructor{fun}\AgdaSpace{}%
\AgdaBound{f0}\AgdaSpace{}%
\AgdaBound{ts0}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{fun}\AgdaSpace{}%
\AgdaBound{f1}\AgdaSpace{}%
\AgdaBound{ts1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}\AgdaBound{c}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{=c}}\AgdaSpace{}%
\AgdaString{'='}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∧}}\AgdaSpace{}%
\AgdaFunction{fi<?}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{f0}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{functor=?}\AgdaSpace{}%
\AgdaBound{f0}\AgdaSpace{}%
\AgdaBound{f1}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{terms=?}\AgdaSpace{}%
\AgdaBound{ts0}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{mono-args-lft}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∧}}\AgdaSpace{}%
\AgdaFunction{terms=?}\AgdaSpace{}%
\AgdaBound{ts1}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{mono-args-rgt}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)))}\<%
\\
\>[0]\AgdaCatchallClause{\AgdaFunction{mono-fun?}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{mono-rel?}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Formula}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Bool}\<%
\\
\>[0]\AgdaFunction{mono-rel?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{qtf}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{qtf}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{bct}\AgdaSpace{}%
\AgdaInductiveConstructor{imp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{rel}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{plain}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{c}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaInductiveConstructor{var}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{var}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)))}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}\AgdaBound{c}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{=c}}\AgdaSpace{}%
\AgdaString{'='}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∧}}\AgdaSpace{}%
\AgdaFunction{mono-rel?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{f}\<%
\\
\>[0]\AgdaFunction{mono-rel?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{bct}\AgdaSpace{}%
\AgdaInductiveConstructor{imp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{rel}\AgdaSpace{}%
\AgdaBound{r0}\AgdaSpace{}%
\AgdaBound{ts0}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{rel}\AgdaSpace{}%
\AgdaBound{r1}\AgdaSpace{}%
\AgdaBound{ts1}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}\AgdaFunction{fi<?}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{r0}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{functor=?}\AgdaSpace{}%
\AgdaBound{r0}\AgdaSpace{}%
\AgdaBound{r1}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{terms=?}\AgdaSpace{}%
\AgdaBound{ts0}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{mono-args-lft}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{terms=?}\AgdaSpace{}%
\AgdaBound{ts1}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{mono-args-rgt}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaCatchallClause{\AgdaFunction{mono-rel?}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\<%
\end{code}


%<*tvlright>
\begin{code}%
\>[0]\AgdaFunction{term-vars<?}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Term}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Bool}\<%
\\
\>[0]\AgdaFunction{terms-vars<?}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{List}\AgdaSpace{}%
\AgdaDatatype{Term}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Bool}\<%
\\
\>[0]\AgdaFunction{term-vars<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{var}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{<ᵇ}}\AgdaSpace{}%
\AgdaBound{k}\<%
\\
\>[0]\AgdaFunction{term-vars<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{fun}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{ts}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{terms-vars<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{ts}\<%
\\
\>[0]\AgdaFunction{terms-vars<?}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaInductiveConstructor{[]}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\<%
\\
\>[0]\AgdaFunction{terms-vars<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∷}}\AgdaSpace{}%
\AgdaBound{ts}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{term-vars<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∧}}\AgdaSpace{}%
\AgdaFunction{terms-vars<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{ts}\<%
\end{code}
%</tvlright>

\begin{code}%
\>[0]\AgdaFunction{formula-vars<?}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Formula}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Bool}\<%
\\
\>[0]\AgdaFunction{formula-vars<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{cst}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\<%
\\
\>[0]\AgdaFunction{formula-vars<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{not}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{formula-vars<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{f}\<%
\\
\>[0]\AgdaFunction{formula-vars<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{bct}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{g}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{formula-vars<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∧}}\AgdaSpace{}%
\AgdaFunction{formula-vars<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{g}\<%
\\
\>[0]\AgdaFunction{formula-vars<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{qtf}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{formula-vars<?}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{f}\<%
\\
\>[0]\AgdaFunction{formula-vars<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{rel}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{ts}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{terms-vars<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{ts}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{choice?}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Formula}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Bool}\<%
\\
\>[0]\AgdaFunction{choice?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{qtf}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{choice?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{f}\<%
\\
\>[0]\AgdaFunction{choice?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{bct}\AgdaSpace{}%
\AgdaInductiveConstructor{imp}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{qtf}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{g}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaFunction{formula-lfi<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∧}}\AgdaSpace{}%
\AgdaFunction{formula-vars<?}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∧}}\<%
\\
\>[1][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}%
\>[1323I]\AgdaFunction{formula=?}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{subst-form}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{skm-term-asc}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∨}}\<%
\\
\>[.][@{}l@{}]\<[1323I]%
\>[4]\AgdaFunction{formula=?}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{subst-form}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{skm-term-desc}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
\>[0]\AgdaCatchallClause{\AgdaFunction{choice?}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{pred-def?}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Formula}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Bool}\<%
\\
\>[0]\AgdaFunction{pred-def?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{qtf}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{pred-def?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{f}\<%
\\
\>[0]\AgdaFunction{pred-def?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{bct}\AgdaSpace{}%
\AgdaInductiveConstructor{iff}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{rel}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{indexed}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ts}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}\AgdaBound{k}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{=n}}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{formula-lfi<?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∧}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{formula-vars<?}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∧}}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{(}\AgdaFunction{terms=?}\AgdaSpace{}%
\AgdaBound{ts}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{vars-asc}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∨}}\AgdaSpace{}%
\AgdaFunction{terms=?}\AgdaSpace{}%
\AgdaBound{ts}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{vars-desc}\AgdaSpace{}%
\AgdaBound{a}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaCatchallClause{\AgdaFunction{pred-def?}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{adm?}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Formula}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Bool}\<%
\\
\>[0]\AgdaFunction{adm?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{formula=?}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{cst}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∨}}\<%
\\
%
\>[2]\AgdaFunction{formula=?}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{not}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{cst}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∨}}\<%
\\
%
\>[2]\AgdaFunction{formula=?}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaFunction{refl-axiom}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∨}}\<%
\\
%
\>[2]\AgdaFunction{formula=?}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaFunction{symm-axiom}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∨}}\<%
\\
%
\>[2]\AgdaFunction{formula=?}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaFunction{trans-axiom}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∨}}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[1]\AgdaFunction{mono-rel?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∨}}\<%
\\
%
\>[1]\AgdaFunction{mono-fun?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∨}}\<%
\\
%
\>[1]\AgdaFunction{choice?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∨}}\<%
\\
%
\>[1]\AgdaFunction{pred-def?}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaBound{f}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{analyze-a}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Bool}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Formula}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Formula}\<%
\\
\>[0]\AgdaFunction{analyze-a}\AgdaSpace{}%
\AgdaInductiveConstructor{false}%
\>[17]\AgdaSymbol{(}\AgdaInductiveConstructor{bct}\AgdaSpace{}%
\AgdaInductiveConstructor{and}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[34]\AgdaBound{f}\<%
\\
\>[0]\AgdaFunction{analyze-a}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{bct}\AgdaSpace{}%
\AgdaInductiveConstructor{and}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[32]\AgdaBound{f}\<%
\\
\>[0]\AgdaFunction{analyze-a}\AgdaSpace{}%
\AgdaInductiveConstructor{false}%
\>[17]\AgdaSymbol{(}\AgdaInductiveConstructor{not}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{bct}\AgdaSpace{}%
\AgdaInductiveConstructor{or}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}))}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{not}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{analyze-a}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{not}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{bct}\AgdaSpace{}%
\AgdaInductiveConstructor{or}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{not}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{analyze-a}\AgdaSpace{}%
\AgdaInductiveConstructor{false}%
\>[17]\AgdaSymbol{(}\AgdaInductiveConstructor{not}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{bct}\AgdaSpace{}%
\AgdaInductiveConstructor{imp}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}))}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{f}\<%
\\
\>[0]\AgdaFunction{analyze-a}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{not}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{bct}\AgdaSpace{}%
\AgdaInductiveConstructor{imp}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{not}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{analyze-a}\AgdaSpace{}%
\AgdaInductiveConstructor{false}%
\>[17]\AgdaSymbol{(}\AgdaInductiveConstructor{bct}\AgdaSpace{}%
\AgdaInductiveConstructor{iff}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{g}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{bct}\AgdaSpace{}%
\AgdaInductiveConstructor{imp}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{g}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{analyze-a}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{bct}\AgdaSpace{}%
\AgdaInductiveConstructor{iff}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{g}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{bct}\AgdaSpace{}%
\AgdaInductiveConstructor{imp}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaCatchallClause{\AgdaFunction{analyze-a}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{cst}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{analyze-b}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Bool}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Formula}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Formula}\<%
\\
\>[0]\AgdaFunction{analyze-b}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{bct}\AgdaSpace{}%
\AgdaInductiveConstructor{or}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{g}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{f}\<%
\\
\>[0]\AgdaFunction{analyze-b}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{not}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{bct}\AgdaSpace{}%
\AgdaInductiveConstructor{and}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{g}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{not}\AgdaSpace{}%
\AgdaBound{f}\<%
\\
\>[0]\AgdaFunction{analyze-b}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{bct}\AgdaSpace{}%
\AgdaInductiveConstructor{imp}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{g}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{not}\AgdaSpace{}%
\AgdaBound{f}\<%
\\
\>[0]\AgdaFunction{analyze-b}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{not}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{bct}\AgdaSpace{}%
\AgdaInductiveConstructor{iff}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{g}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{not}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{bct}\AgdaSpace{}%
\AgdaInductiveConstructor{imp}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{g}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{analyze-b}\AgdaSpace{}%
\AgdaInductiveConstructor{true}%
\>[16]\AgdaSymbol{(}\AgdaInductiveConstructor{bct}\AgdaSpace{}%
\AgdaInductiveConstructor{or}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{g}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{g}\<%
\\
\>[0]\AgdaFunction{analyze-b}\AgdaSpace{}%
\AgdaInductiveConstructor{true}%
\>[16]\AgdaSymbol{(}\AgdaInductiveConstructor{not}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{bct}\AgdaSpace{}%
\AgdaInductiveConstructor{and}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{g}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{not}\AgdaSpace{}%
\AgdaBound{g}\<%
\\
\>[0]\AgdaFunction{analyze-b}\AgdaSpace{}%
\AgdaInductiveConstructor{true}%
\>[16]\AgdaSymbol{(}\AgdaInductiveConstructor{bct}\AgdaSpace{}%
\AgdaInductiveConstructor{imp}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{g}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{g}\<%
\\
\>[0]\AgdaFunction{analyze-b}\AgdaSpace{}%
\AgdaInductiveConstructor{true}%
\>[16]\AgdaSymbol{(}\AgdaInductiveConstructor{not}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{bct}\AgdaSpace{}%
\AgdaInductiveConstructor{iff}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{g}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{not}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{bct}\AgdaSpace{}%
\AgdaInductiveConstructor{imp}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaCatchallClause{\AgdaFunction{analyze-b}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{⊤*}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{analyze-c}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Term}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Formula}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Formula}\<%
\\
\>[0]\AgdaFunction{analyze-c}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{qtf}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[29]\AgdaSymbol{(}\AgdaFunction{subst-form}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{analyze-c}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{not}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{qtf}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[34]\AgdaSymbol{(}\AgdaInductiveConstructor{not}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{subst-form}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaCatchallClause{\AgdaFunction{analyze-c}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{⊤*}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{analyze-d}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Nat}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Formula}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Formula}\<%
\\
\>[0]\AgdaFunction{analyze-d}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{qtf}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[28]\AgdaSymbol{(}\AgdaFunction{subst-form}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{par}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{analyze-d}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{not}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{qtf}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[35]\AgdaSymbol{(}\AgdaInductiveConstructor{not}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{subst-form}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{par}\AgdaSpace{}%
\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaCatchallClause{\AgdaFunction{analyze-d}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{⊤*}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{analyze-n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Formula}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Formula}\<%
\\
\>[0]\AgdaFunction{analyze-n}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{not}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{not}\AgdaSpace{}%
\AgdaBound{f}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{=}%
\>[27]\AgdaBound{f}\<%
\\
\>[0]\AgdaCatchallClause{\AgdaFunction{analyze-n}}\AgdaSpace{}%
\AgdaCatchallClause{\AgdaSymbol{\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{⊤*}\<%
\end{code}

%<*verify-c>
\begin{code}%
\>[0]\AgdaFunction{verify}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Sequent}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Proof}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Bool}\<%
\\
\>[0]\AgdaFunction{verify}\AgdaSpace{}%
\AgdaBound{Γ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{rule-c}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{term-lfi<?}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{size}\AgdaSpace{}%
\AgdaBound{Γ}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∧}}\<%
\\
%
\>[2]\AgdaFunction{verify}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{add}\AgdaSpace{}%
\AgdaBound{Γ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{analyze-c}\AgdaSpace{}%
\AgdaBound{t}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nth}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaBound{Γ}\AgdaSymbol{)))}\AgdaSpace{}%
\AgdaBound{p}\<%
\end{code}
%</verify-c>

\begin{code}%
\>[0]\AgdaFunction{verify}\AgdaSpace{}%
\AgdaBound{Γ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{rule-a}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{verify}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{add}\AgdaSpace{}%
\AgdaBound{Γ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{analyze-a}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nth}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaBound{Γ}\AgdaSymbol{)))}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaFunction{verify}\AgdaSpace{}%
\AgdaBound{Γ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{rule-b}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}\AgdaFunction{verify}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{add}\AgdaSpace{}%
\AgdaBound{Γ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{analyze-b}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nth}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaBound{Γ}\AgdaSymbol{)))}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∧}}\<%
\\
%
\>[2]\AgdaSymbol{(}\AgdaFunction{verify}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{add}\AgdaSpace{}%
\AgdaBound{Γ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{analyze-b}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nth}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaBound{Γ}\AgdaSymbol{)))}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{verify}\AgdaSpace{}%
\AgdaBound{Γ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{rule-d}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{verify}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{add}\AgdaSpace{}%
\AgdaBound{Γ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{analyze-d}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{size}\AgdaSpace{}%
\AgdaBound{Γ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nth}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaBound{Γ}\AgdaSymbol{)))}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaFunction{verify}\AgdaSpace{}%
\AgdaBound{Γ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{rule-n}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{verify}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{add}\AgdaSpace{}%
\AgdaBound{Γ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{analyze-n}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nth}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaBound{Γ}\AgdaSymbol{)))}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaFunction{verify}\AgdaSpace{}%
\AgdaBound{Γ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{rule-s}\AgdaSpace{}%
\AgdaBound{ϕ}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{q}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{formula-lfi<?}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{size}\AgdaSpace{}%
\AgdaBound{Γ}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{ϕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∧}}\<%
\\
%
\>[2]\AgdaFunction{verify}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{add}\AgdaSpace{}%
\AgdaBound{Γ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{not}\AgdaSpace{}%
\AgdaBound{ϕ}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∧}}\AgdaSpace{}%
\AgdaFunction{verify}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{add}\AgdaSpace{}%
\AgdaBound{Γ}\AgdaSpace{}%
\AgdaBound{ϕ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{q}\<%
\\
\>[0]\AgdaFunction{verify}\AgdaSpace{}%
\AgdaBound{Γ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{rule-t}\AgdaSpace{}%
\AgdaBound{ϕ}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{adm?}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{size}\AgdaSpace{}%
\AgdaBound{Γ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{ϕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∧}}\AgdaSpace{}%
\AgdaFunction{verify}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{add}\AgdaSpace{}%
\AgdaBound{Γ}\AgdaSpace{}%
\AgdaBound{ϕ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{p}\<%
\\
\>[0]\AgdaFunction{verify}\AgdaSpace{}%
\AgdaBound{Γ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{rule-x}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaBound{j}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{formula=?}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nth}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaBound{Γ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{not}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nth}\AgdaSpace{}%
\AgdaBound{j}\AgdaSpace{}%
\AgdaBound{Γ}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{elim-res}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Chars}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{String}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{B}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Res}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{B}\<%
\\
\>[0]\AgdaFunction{elim-res}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{cont}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaBound{cs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaBound{cs}\<%
\\
\>[0]\AgdaFunction{elim-res}\AgdaSpace{}%
\AgdaBound{f}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{stop}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{g}\AgdaSpace{}%
\AgdaBound{s}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{parse-verify}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Chars}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Chars}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Bool}\<%
\\
\>[0]\AgdaFunction{parse-verify}\AgdaSpace{}%
\AgdaBound{cs-bch}\AgdaSpace{}%
\AgdaBound{cs-prf}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{elim-res}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{elim-res}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{p}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{verify}\AgdaSpace{}%
\AgdaBound{B}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{parse-prf}\AgdaSpace{}%
\AgdaBound{cs-prf}\AgdaSymbol{))}\<%
\\
%
\>[4]\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{(}\AgdaFunction{parse-sequent}\AgdaSpace{}%
\AgdaBound{cs-bch}\AgdaSymbol{)}\<%
\end{code}